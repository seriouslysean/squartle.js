/**
 * Splitleaf_Squartle
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the MIT LICENSE
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/MIT
 *
 * @category   Splitleaf
 * @package    Splitleaf_Squartle
 * @copyright  Copyright 2013 Splitleaf, LLC
 * @license    http://opensource.org/licenses/MIT
 * @author     Sean Kennedy <sean@splitleaf.net>
 * @version    1.0.0
 */
(function(e,t,n,r){function o(t,n){this.element=t;this.options=e.extend({},s,n);this._defaults=s;this._name=i;this.init()}var i="squartle";var s={containerClass:"squartle-container",heroEnable:true,heroContainerClass:"squartle-heroes",heroClass:"squartle-hero",heroDefault:0,linkClass:"squartle-link",listClass:"squartle-items",itemClass:"squartle-item",imageClass:"squartle-image",imageHoverClass:"squartle-image-hover",videoContainerClass:"squartle-videos",videoClass:"squartle-video",itemsAcross:3,videoCustomSelector:false};o.prototype={init:function(){this._setupOptions(this.element,this.options);this._setupElements(this.element,this.options);this._setupStyles(this.element,this.options);this._setupHover(this.element,this.options);this._setupClick(this.element,this.options);this._setupResize(this.element,this.options)},_setupOptions:function(t,n){this.options.hasHeroes=e("> ul > li > div",t).length?true:false},_setupElements:function(t,n){e("> ul > li img",t).each(function(){e(this).addClass(n.imageClass);e(this).parentsUntil(t,"a").addClass(n.linkClass);e(this).parentsUntil(t,"li").addClass(n.itemClass);e(this).parentsUntil(t,"ul").addClass(n.listClass);if(e(this).data("hover")){hover=e("<img>").attr({src:e(this).data("hover"),alt:e(this).attr("alt")}).addClass(n.imageHoverClass);e(e(this).parent()).append(hover)}});if(n.hasHeroes){heroesContainer=e("<div>").addClass(n.heroContainerClass);e(t).prepend(heroesContainer);e("li",t).each(function(){heroes=e("> div",this).addClass(n.heroClass);e(heroes).each(function(){var t=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];if(n.videoCustomSelector)t.push(n.videoCustomSelector);heroVideos=e(this).find(t.join(",")).not("object object");e(heroVideos).each(function(){heroVideos=e("<div>").addClass(n.videoContainerClass);e(this).addClass(n.videoClass).wrap(heroVideos)})});e("> div",t).append(heroes)})}},_setupStyles:function(t,n){e(t).css({"max-width":"100%",overflow:"hidden",width:"100%"});e("."+n.heroContainerClass,t).css({position:"relative",height:"auto",overflow:"hidden"});e("."+n.heroClass,t).css({position:"absolute","float":"none",height:"auto",top:"0",left:"0","z-index":0,opacity:0,overflow:"hidden"});e("."+n.videoContainerClass,t).css({width:"100%",height:"0"});videos=e("."+n.videoClass,t);e(videos).each(function(){aspectRatio=e(this).height()/e(this).width();e(this).parent().css("padding","0 0 "+aspectRatio*100+"% 0");e(this).css({top:0,left:0,width:"100%",height:"100%"})});e("."+n.listClass).css("display","inline");width=100/n.itemsAcross;e("."+n.itemClass,t).css({overflow:"hidden","float":"left",display:"block",position:"relative",width:width+"%"});e("."+n.linkClass).css("display","inline");e("."+n.imageClass,t).css({display:"block",height:"auto","max-width":"100%",width:"100%"});e("."+n.imageHoverClass,t).css({display:"none",height:"auto","max-width":"100%",width:"100%",position:"absolute",top:"0",left:"0","z-index":"10"})},_setupHover:function(t,n){if(e("."+n.linkClass,t).length){e("."+n.linkClass,t).each(function(){e(this).hover(function(t){t.preventDefault();if(!e(this).hasClass("active"))e("> ."+n.imageHoverClass,this).finish().fadeIn("fast")},function(t){t.preventDefault();if(!e(this).hasClass("active"))e("> ."+n.imageHoverClass,this).finish().fadeOut("fast")})})}},_setupClick:function(t,n){e("."+n.linkClass,t).click(function(r){r.preventDefault();notActive=e("> a",e(this).parent().siblings().not(e(this).parent()));notActive.removeClass("active");e("> ."+n.imageHoverClass,notActive).finish().fadeOut("fast");e(this).addClass("active");e("> ."+n.imageHoverClass,this).finish().fadeIn("fast");if(n.hasHeroes){hero=e("."+n.heroClass,t).get(e(this).parent().index());heroAll=e("."+n.heroClass,t);heroNotActive=e("."+n.heroClass,t).not(hero);e(heroAll).removeClass("active").css({position:"absolute","float":"left"}).animate({"z-index":0,opacity:0},{duration:"fast",queue:false});e(hero).addClass("active").css({position:"relative","float":"none"}).animate({"z-index":10,opacity:1},{duration:"fast",queue:false})}})}};e.fn[i]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+i)){e.data(this,"plugin_"+i,new o(this,t))}})}})(jQuery,window,document)